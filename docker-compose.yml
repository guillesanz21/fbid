version: "3.9"
services:
  mongo:
    image: mongo
    container_name: mongo
    labels:
      name: fbid.mongo
      description: "FBID (MUIRST - ETSIT - UPM) final assigment - Mongo container"
    restart: always
    ports:
      - 27017:27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: fbid

  mongo-express:
    image: mongo-express
    container_name: mongo-express
    labels:
      name: fbid.mongo-express
      description: "FBID (MUIRST - ETSIT - UPM) final assigment - Mongo express container"
    restart: always
    ports:
      - 8081:8081
    environment:
      ME_CONFIG_MONGODB_ADMINUSERNAME: root
      ME_CONFIG_MONGODB_ADMINPASSWORD: fbid
      ME_CONFIG_MONGODB_URL: mongodb://root:fbid@mongo:27017/


  # zookeeper:
  #   image: "bitnami/kafka:3.0.0"
  #   container_name: zookeeper
  #   labels:
  #     name: fbid.zk
  #     description: "FBID (MUIRST - ETSIT - UPM) final assigment - Zookeeper node"
  #   ports:
  #     - "9092:9092"
  #   environment:
  #     - KAFKA_BROKER_ID=1
  #     - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092
  #     - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://127.0.0.1:9092
  #     - KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper:2181
  #     - ALLOW_PLAINTEXT_LISTENER=yes
  #   depends_on:
  #     - zookeeper

 

  # web:
  #   # build:
  #     # Aqui hace falta hacer un Dockerfile e instalar las dependencias de "requirements.txt".
  #     context:
  #     dockerfile:
  #   container_name: web
  #   labels:
  #     name: fbid.web
  #     description: "FBID (MUIRST - ETSIT - UPM) final assigment - Flask web container"
  #   depends_on:
  #     - mongo
  #     - mongo-express

  zookeeper:
    image: zookeeper:3.6.3
    hostname: zookeeper
    container_name: zookeeper
    labels:
      name: fbid.zoo
      description: "FBID (MUIRST - ETSIT - UPM) final assigment - Zookeeper node"
    # command: sh -c "bin/zookeeper-server-start.sh config/zookeeper.properties"
    restart: always
    ports:
      - 2181:2181

  kafka:
    image: "bitnami/kafka:3.0.0"
    container_name: kafka
    labels:
      name: fbid.kafka
      description: "FBID (MUIRST - ETSIT - UPM) final assigment - Kafka node"
    ports:
      - "9092:9092"
    environment:
      - KAFKA_BROKER_ID=1
      - KAFKA_CFG_LISTENERS=PLAINTEXT://:9092
      - KAFKA_CFG_ADVERTISED_LISTENERS=PLAINTEXT://127.0.0.1:9092
      - KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper:2181
      - ALLOW_PLAINTEXT_LISTENER=yes
    depends_on:
      - zookeeper

